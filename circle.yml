## Customize checkout
checkout:
  post:
    - git submodule sync
    - git submodule update --init # use submodules

machine:
  timezone: Asia/Tokyo

#  hosts:  #/etc/hosts を書き換える
#    xxxxxx.com: 127.0.0.1

  environment:
    GRADLE_OPTS: -Xmx4G -Dorg.gradle.daemon=true

  java:
    version: openjdk7

  post:
  - sudo service mysql stop
  - sudo service postgresql stop

dependencies:
  override:
    - ./gradlew -v
    - ./gradlew testClasses

test:
  pre:
    - echo "----- start test -----"
  override:
    - ./gradlew --full-stacktrace check
  post:
    # jUnitをCircleCIで可視化するための記述(see:http://qiita.com/tomoima525/items/b4a91d1624aaf0112b3f)
    - mkdir -p $CIRCLE_TEST_REPORTS/junit/
    - find . -type f -regex ".*/test-results/*/.*xml" -exec cp {} $CIRCLE_TEST_REPORTS/junit/ \;

    - echo "------ end test ------"

general:
  artifacts:
    - "app/build/reports/tests"
    - "app/build/reports/pmd"
    - "app/build/reports/findbugs"
